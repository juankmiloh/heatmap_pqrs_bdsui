{
        "name": "pqrs_causas",
        "query" : [
                "SELECT ",
                "    SERVICIO,",
                "    COD_CAUSA,",
                "    CONVERT(DESC_CAUSA, 'US7ASCII', 'WE8ISO8859P1'),",
                "    SUM (Q.NUMERO_QUEJAS) NUMERO ",
                "FROM ",
                "    (",
                "        SELECT ",
                "            'ENERGIA' SERVICIO,",
                "            CAR_CARG_ANO ANIO,",
                "            CAR_T1548_CAUSAL_DETALLE COD_CAUSA,",
                "            PQRENE.DESCRIPCION_CAUSAL DESC_CAUSA,",
                "            COUNT (DISTINCT(FE.CAR_T1548_RAD_RECIBIDO)) NUMERO_QUEJAS ",
                "        FROM ",
                "            SUI_SIMPLIFICA_2015.CAR_T1548_RECLAMACIONES_ENE FE, PQR_CAUSAL_ENE PQRENE ",
                "        WHERE ",
                "                CAR_CARG_ANO = :ANIO_ARG ",
                "            AND FE.CAR_T1548_CAUSAL_DETALLE = PQRENE.IDENTIFICADOR_CAUSAL",
                "            AND (IDENTIFICADOR_EMPRESA = :EMPRESA_ARG OR 0 = :EMPRESA_ARG)",
                "            AND ( CAR_CARG_PERIODO = :PERIODO_ARG OR :PERIODO_ARG = 0 ) ",
                "            AND ( 'ENERGIA' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG ) ",
                "            AND ( CAR_T1548_CAUSAL_DETALLE = :CAUSA_ARG OR :CAUSA_ARG = 0 ) ",
                "            GROUP BY CAR_CARG_ANO, CAR_T1548_CAUSAL_DETALLE, PQRENE.DESCRIPCION_CAUSAL ",
                "        UNION ",
                "        SELECT ",
                "            'GAS' SERVICIO,",
                "            CAR_CARG_ANO ANIO,",
                "            CAR_T1552_CAUSAL_DETALLE COD_CAUSA,",
                "            PQRGAS.DESCRIPCION_CAUSAL DESC_CAUSA,",
                "            COUNT (DISTINCT(FG.CAR_T1552_RAD_RECIBIDO)) NUMERO_QUEJAS ",
                "        FROM ",
                "            SUI_SIMPLIFICA_2015.CAR_T1552_RECLAMACIONES_GAS FG, PQR_CAUSAL_GAS PQRGAS ",
                "        WHERE ",
                "                CAR_CARG_ANO = :ANIO_ARG ",
                "            AND FG.CAR_T1552_CAUSAL_DETALLE = PQRGAS.IDENTIFICADOR_CAUSAL  ",
                "            AND (IDENTIFICADOR_EMPRESA = :EMPRESA_ARG OR 0 = :EMPRESA_ARG)",
                "            AND (CAR_CARG_PERIODO = :PERIODO_ARG OR :PERIODO_ARG = 0 ) ",
                "            AND ( 'GAS' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG ) ",
                "            AND ( CAR_T1552_CAUSAL_DETALLE = :CAUSA_ARG OR :CAUSA_ARG = 0 ) ",
                "        GROUP BY CAR_CARG_ANO, CAR_T1552_CAUSAL_DETALLE, PQRGAS.DESCRIPCION_CAUSAL ",
                "        UNION ",
                "        SELECT ",
                "            'GLP' SERVICIO,",
                "            CAR_CARG_ANO ANIO,",
                "            FGL.CAR_T1554_CAUSAL_DETALLE COD_CAUSA,",
                "            PQRGLP.DESCRIPCION_CAUSAL DESC_CAUSA,",
                "            COUNT (DISTINCT(FGL.CAR_T1554_RAD_RECIBIDO)) NUMERO_QUEJAS ",
                "        FROM ",
                "            SUI_SIMPLIFICA_2015.CAR_T1554_RECLAMACIONES_GLP FGL, PQR_CAUSAL_GLP PQRGLP ",
                "        WHERE ",
                "                CAR_CARG_ANO = :ANIO_ARG ",
                "            AND FGL.CAR_T1554_CAUSAL_DETALLE = PQRGLP.IDENTIFICADOR_CAUSAL",
                "            AND (IDENTIFICADOR_EMPRESA = :EMPRESA_ARG OR 0 = :EMPRESA_ARG)",
                "            AND (CAR_CARG_PERIODO = :PERIODO_ARG OR :PERIODO_ARG = 0 ) ",
                "            AND ( 'GLP' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG )",
                "            AND ( CAR_T1554_CAUSAL_DETALLE = :CAUSA_ARG OR :CAUSA_ARG = 0 ) ",
                "        GROUP BY CAR_CARG_ANO, CAR_T1554_CAUSAL_DETALLE, PQRGLP.DESCRIPCION_CAUSAL ",
                "    ) Q ",
                "GROUP BY SERVICIO,COD_CAUSA,DESC_CAUSA ",
                "ORDER BY NUMERO DESC"
        ]
}