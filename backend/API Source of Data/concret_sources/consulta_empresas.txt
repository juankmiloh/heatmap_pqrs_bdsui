{
	"name": "empresas",
	"query" : [
		SELECT EMP.ARE_ESP_SECUE,
		       EMP.ARE_ESP_NOMBRE,
		       SER.PAR_SERV_NOMBRE 
		FROM 
		      ARE_ESP_EMPRESAS EMP,
		      PAR_SERV_SERVICIOS SER,
		      ARE_SEES_SERESP ROM,
		      ARE_NESP_NATESP NES,
		      ARE_ACES_ACTESP ACT 
		WHERE 
		      ROM.ARE_ESP_SECUE = EMP.ARE_ESP_SECUE
		      AND ROM.PAR_SERV_SECUE = SER.PAR_SERV_SECUE
		      AND ROM.ARE_ESP_SECUE = NES.ARE_ESP_SECUE
		      AND ROM.ARE_ESP_SECUE = ACT.ARE_ESP_SECUE
		      AND SER.PAR_SERV_SECUE IN (4)
		      AND ( 'ENERGIA' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG )
		      AND EMP.ARE_ESP_SECUE < 99900
		      AND ROM.ARE_SEES_ESTADO = 'O'
		      AND NES.ARE_NESP_ESTADO = 'O'
		      AND ACT.ARE_ACES_ESTADO = 'O'
		      AND EMP.ARE_ESP_ACTUALIZA IS NOT NULL
		      AND EMP.ARE_ESP_ESTACT = 'A'
		      AND EMP.ARE_ESP_SECUE_CREG <> 0 
		GROUP BY 
		         EMP.ARE_ESP_SECUE,
		         EMP.ARE_ESP_NOMBRE,
		         SER.PAR_SERV_NOMBRE,
		         EMP.ARE_ESP_ACTUALIZA,
		         EMP.ARE_ESP_ESTACT,
		         EMP.ARE_ESP_SECUE_CREG 
		UNION 
		SELECT EMP.ARE_ESP_SECUE,
		       EMP.ARE_ESP_NOMBRE,
		       SER.PAR_SERV_NOMBRE 
		FROM 
		      ARE_ESP_EMPRESAS EMP,
		      PAR_SERV_SERVICIOS SER,
		      ARE_SEES_SERESP ROM,
		      ARE_NESP_NATESP NES,
		      ARE_ACES_ACTESP ACT 
		WHERE 
		      ROM.ARE_ESP_SECUE = EMP.ARE_ESP_SECUE
		      AND ROM.PAR_SERV_SECUE = SER.PAR_SERV_SECUE
		      AND ROM.ARE_ESP_SECUE = NES.ARE_ESP_SECUE
		      AND ROM.ARE_ESP_SECUE = ACT.ARE_ESP_SECUE
		      AND SER.PAR_SERV_SECUE IN (5)
		      AND ( 'GAS' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG )
		      AND EMP.ARE_ESP_SECUE < 99900
		      AND ROM.ARE_SEES_ESTADO = 'O'
		      AND NES.ARE_NESP_ESTADO = 'O'
		      AND ACT.ARE_ACES_ESTADO = 'O'
		      AND EMP.ARE_ESP_ACTUALIZA IS NOT NULL
		      AND EMP.ARE_ESP_ESTACT = 'A'
		      AND EMP.ARE_ESP_SECUE_CREG <> 0 
		GROUP BY 
		         EMP.ARE_ESP_SECUE,
		         EMP.ARE_ESP_NOMBRE,
		         SER.PAR_SERV_NOMBRE,
		         EMP.ARE_ESP_ACTUALIZA,
		         EMP.ARE_ESP_ESTACT,
		         EMP.ARE_ESP_SECUE_CREG 
		UNION 
		SELECT EMP.ARE_ESP_SECUE,
		       EMP.ARE_ESP_NOMBRE,
		       SER.PAR_SERV_NOMBRE 
		FROM 
		      ARE_ESP_EMPRESAS EMP,
		      PAR_SERV_SERVICIOS SER,
		      ARE_SEES_SERESP ROM,
		      ARE_NESP_NATESP NES,
		      ARE_ACES_ACTESP ACT 
		WHERE 
		      ROM.ARE_ESP_SECUE = EMP.ARE_ESP_SECUE
		      AND ROM.PAR_SERV_SECUE = SER.PAR_SERV_SECUE
		      AND ROM.ARE_ESP_SECUE = NES.ARE_ESP_SECUE
		      AND ROM.ARE_ESP_SECUE = ACT.ARE_ESP_SECUE
		      AND SER.PAR_SERV_SECUE IN (7)
		      AND ( 'GLP' = :SERVICIO_ARG OR 'TODOS' = :SERVICIO_ARG )
		      AND EMP.ARE_ESP_SECUE < 99900
		      AND ROM.ARE_SEES_ESTADO = 'O'
		      AND NES.ARE_NESP_ESTADO = 'O'
		      AND ACT.ARE_ACES_ESTADO = 'O'
		      AND EMP.ARE_ESP_ACTUALIZA IS NOT NULL
		      AND EMP.ARE_ESP_ESTACT = 'A'
		      AND EMP.ARE_ESP_SECUE_CREG <> 0 
		GROUP BY 
		         EMP.ARE_ESP_SECUE,
		         EMP.ARE_ESP_NOMBRE,
		         SER.PAR_SERV_NOMBRE,
		         EMP.ARE_ESP_ACTUALIZA,
		         EMP.ARE_ESP_ESTACT,
		         EMP.ARE_ESP_SECUE_CREG 
		ORDER BY 
		ARE_ESP_NOMBRE AS
	]   
}
